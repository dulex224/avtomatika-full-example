# Avtomatika: –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç (Full Showcase)

[EN](./README.md) | RU

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã **Avtomatika HLN (Hierarchical Logic Network)**. –ó–¥–µ—Å—å —Å–æ–±—Ä–∞–Ω—ã –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã: –æ—Ç –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á –¥–æ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

–ü—Ä–∏–º–µ—Ä —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é —Å—Ä–µ–¥—É:

![–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å](docs/images/full_showcase_graph.png)

1.  **Orchestrator**: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —É–∑–µ–ª, —É–ø—Ä–∞–≤–ª—è—é—â–∏–π –±–ª—É–ø—Ä–∏–Ω—Ç–æ–º `full_showcase`.
2.  **GPU Worker**: –í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –≤–æ—Ä–∫–µ—Ä –¥–ª—è "—Ç—è–∂–µ–ª—ã—Ö" –∑–∞–¥–∞—á (—Ç—Ä–∞–Ω—Å–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ).
3.  **CPU Workers**: –î–≤–∞ –≤–æ—Ä–∫–µ—Ä–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∞–π–ª–æ–≤ (–æ–¥–∏–Ω —Å—Ç–∞–±–∏–ª—å–Ω—ã–π, –¥—Ä—É–≥–æ–π ‚Äî –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–ø—É—Ç–∞—Ü–∏–∏).

### ü™Ü –õ–æ–≥–∏–∫–∞ –ø–æ–¥–ø—Ä–æ—Ü–µ—Å—Å–æ–≤
–î–æ—á–µ—Ä–Ω–∏–π –±–ª—É–ø—Ä–∏–Ω—Ç `metadata_enrichment`:
![–ü–æ–¥–ø—Ä–æ—Ü–µ—Å—Å](docs/images/metadata_enrichment_graph.png)

4.  **Scheduler**: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫, –∑–∞–ø—É—Å–∫–∞—é—â–∏–π –∑–∞–¥–∞—á–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.
5.  **Webhook Receiver**: –í–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–µ –∑–∞–¥–∞—á –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
6.  **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: 
    *   **Redis**: –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á.
    *   **PostgreSQL**: –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏ –∞—É–¥–∏—Ç.
    *   **MinIO (S3)**: –•—Ä–∞–Ω–µ–Ω–∏–µ —Ç—è–∂–µ–ª—ã—Ö —Ñ–∞–π–ª–æ–≤ (payload offloading).
    *   **VictoriaMetrics & Grafana**: –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
    *   **Jaeger**: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ (OpenTelemetry).

## üåü –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ

### 1. –ù–∞—Ç–∏–≤–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (Scheduler) ‚è∞
–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ `schedules.toml`. –í –ø—Ä–∏–º–µ—Ä–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∑–∞–¥–∞—á–∞ `maintenance_task`, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –±–ª—É–ø—Ä–∏–Ω—Ç –æ—á–∏—Å—Ç–∫–∏.

### 2. –¶–µ–ø–æ—á–∫–∏ –∏ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å (Sub-Blueprints) ü™Ü
–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å `full_showcase` –∑–∞–ø—É—Å–∫–∞–µ—Ç –¥–æ—á–µ—Ä–Ω–∏–π –±–ª—É–ø—Ä–∏–Ω—Ç `metadata_enrichment`. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑–±–∏–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ, –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–ª–æ–∫–∏.

### 3. –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º (Fan-Out/Fan-In) üöÄ
–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–¥–∞—á –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∞–π–ª–æ–≤. –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –∂–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤–µ—Ç–æ–∫ –∏ –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –æ–¥–∏–Ω –æ—Ç—á–µ—Ç.

### 4. –£–º–Ω–∞—è –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏—è üß†
–í –ø—Ä–∏–º–µ—Ä–µ –ø–æ–∫–∞–∑–∞–Ω—ã —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤—ã–±–æ—Ä–∞ –≤–æ—Ä–∫–µ—Ä–æ–≤:
*   `default`: –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ —Å —É—á–µ—Ç–æ–º –∫—ç—à–∞ –Ω–∞–≤—ã–∫–æ–≤.
*   `best_value`: –í—ã–±–æ—Ä –≤–æ—Ä–∫–µ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è "—Ü–µ–Ω–∞/—Ä–µ–ø—É—Ç–∞—Ü–∏—è".
*   `round_robin`: –¶–∏–∫–ª–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ.

### 5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Webhooks üì°
–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á–∏ —á–µ—Ä–µ–∑ `client.py` —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è `webhook_url`. –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –æ—Ç–ø—Ä–∞–≤–∏—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ `webhook_receiver` —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–ª–∏ –ø—Ä–æ–≤–∞–ª–∞ –∑–∞–¥–∞—á–∏.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ (Docker)

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± —É–≤–∏–¥–µ—Ç—å –≤—Å—ë –≤ –¥–µ–π—Å—Ç–≤–∏–∏ ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Docker Compose.

1.  **–ó–∞–ø—É—Å–∫ —Å—Ç–µ–∫–∞**:
    ```bash
    cd projects/avtomatika_full_example
    docker compose up -d --build
    ```

2.  **–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞**:
    –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç –∑–∞–¥–∞—á—É –∏ –ø–æ–∫–∞–∂–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä:
    ```bash
    # –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
    python3 -m venv .venv
    source .venv/bin/activate
    pip install aiohttp
    python3 client.py
    ```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã:
*   **Grafana**: [http://localhost:3000](http://localhost:3000) (–î–∞—à–±–æ—Ä–¥ "Avtomatika Overview").
*   **Jaeger (Traces)**: [http://localhost:16686](http://localhost:16686).
*   **API Docs (Swagger)**: [http://localhost:8080/_public/docs](http://localhost:8080/_public/docs).
*   **–ú–µ—Ç—Ä–∏–∫–∏ (Prometheus)**: [http://localhost:8080/_public/metrics](http://localhost:8080/_public/metrics).

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

*   `full_example.py`: –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
*   `config.py`: –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
*   `blueprints/`: –ü–∞–∫–µ—Ç —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ (–±–ª—É–ø—Ä–∏–Ω—Ç–æ–≤).
*   `workers/`: –ö–∞—Ç–∞–ª–æ–≥ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –≤–æ—Ä–∫–µ—Ä–æ–≤ (GPU, Reliable CPU, Unreliable CPU).
*   `webhook_receiver.py`: –°–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–∏–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.
*   `schedules.toml`: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á.
*   `example_clients.toml`: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è API-–∫–ª—é—á–µ–π.
*   `ops/`: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (VictoriaMetrics, Grafana).

---
*–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ Dmitrii Gagarin aka madgagarin.*
